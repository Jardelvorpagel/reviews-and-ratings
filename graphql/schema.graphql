type Review {
  id: ID!
  cacheId: ID!
  productId: String!
  rating: Int!
  title: String
  text: String
  reviewerName: String
  shopperId: String
  location: String
  reviewDateTime: String
  verifiedPurchaser: Boolean
  sku: String
  approved: Boolean
}

type AppSettings {
  allowAnonymousReviews: Boolean
  requireApproval: Boolean
  useLocation: Boolean
}

type Query {
  review(id: ID!): Review @cacheControl(scope: PRIVATE, maxAge: SHORT)
  reviews(offset: Int, limit: Int, orderBy: String): [Review]
    @cacheControl(scope: PRIVATE, maxAge: SHORT)
  reviewsByProductId(
    productId: String!
    offset: Int
    limit: Int
    orderBy: String
  ): [Review] @cacheControl(scope: PRIVATE, maxAge: SHORT)
  averageRatingByProductId(productId: String!): Float
    @cacheControl(scope: PRIVATE, maxAge: SHORT)
  totalReviewsByProductId(productId: String!): Int
    @cacheControl(scope: PRIVATE, maxAge: SHORT)
  reviewsByShopperId(
    shopperId: String!
    offset: Int
    limit: Int
    orderBy: String
  ): [Review] @cacheControl(scope: PRIVATE, maxAge: SHORT)
  hasShopperReviewed(shopperId: String!, productId: String!): Boolean
    @cacheControl(scope: PRIVATE, maxAge: SHORT)
  appSettings: AppSettings @cacheControl(scope: PUBLIC, maxAge: SHORT)
}

# Mutations

input ReviewInput {
  id: ID
  cacheId: ID
  productId: String!
  rating: Int!
  title: String
  text: String
  reviewerName: String
  location: String
  shopperId: String!
  reviewDateTime: String
  verifiedPurchaser: Boolean!
  sku: String
}

type Mutation {
  newReview(review: ReviewInput!): Review
  editReview(id: ID!, review: ReviewInput!): Review
  deleteReview(id: ID!): Boolean
  moderateReview(ids: [ID!], approved: Boolean!): Boolean
}
